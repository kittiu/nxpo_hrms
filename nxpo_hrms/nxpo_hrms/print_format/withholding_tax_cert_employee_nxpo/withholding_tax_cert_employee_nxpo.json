{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-08-16 15:33:10.926773",
 "css": ".o_report_withholding_tax_cert {\n    background-image:url('/assets/thai_payroll/images/wht/WithholdingTaxCertEmployee.png');\n    background-size:210mm 297mm; width:210mm; height:297mm;\n    position: relative;\n}\n.copy {\n    font-size: 12px;\n    position: absolute;\n    top: 30px;\n    left: 50%;\n    transform: translateX(-50%);\n}\n.signature {\n    font-size: 12px;\n    position: absolute;\n    top: 990px;\n    left: 470px;\n    width:500px;\n}\n.sign_date {\n    font-size: 12px;\n    position: absolute;\n    top: 1007px;\n    left: 490px;\n    width:200px;\n}\n.number {\n    font-size: 12px;\n    position: absolute;\n    top: 65px;\n    left: 50px;\n    width: 200px;\n}\n.number_payment {\n    font-size: 12px;\n    position: absolute;\n    top: 85px;\n    left: 50px;\n    width: 200px;\n}\n.company_vat {\n    font-size: 14px;\n    }\n    .company_vat .company_vat_1 { position: absolute; top: 112px; left: 503px; }\n    .company_vat .company_vat_2 { position: absolute; top: 112px; left: 528px; }\n    .company_vat .company_vat_3 { position: absolute; top: 112px; left: 544px; }\n    .company_vat .company_vat_4 { position: absolute; top: 112px; left: 560px; }\n    .company_vat .company_vat_5 { position: absolute; top: 112px; left: 576px; }\n    .company_vat .company_vat_6 { position: absolute; top: 112px; left: 600px; }\n    .company_vat .company_vat_7 { position: absolute; top: 112px; left: 616px; }\n    .company_vat .company_vat_8 { position: absolute; top: 112px; left: 632px; }\n    .company_vat .company_vat_9 { position: absolute; top: 112px; left: 648px; }\n    .company_vat .company_vat_10 { position: absolute; top: 112px; left: 664px; }\n    .company_vat .company_vat_11 { position: absolute; top: 112px; left: 688px; }\n    .company_vat .company_vat_12 { position: absolute; top: 112px; left: 704px; }\n    .company_vat .company_vat_13 { position: absolute; top: 112px; left: 730px; }\n.company_name {\n    font-size: 11px;\n    position: absolute;\n    top: 135px;\n    left: 68px; \n    width: 1000px;\n}\n.company_address {\n    font-size: 14px;\n    position: absolute;\n    top: 164px;\n    left: 80px; \n    width: 1000px;\n}\n.employee_tax {\n    font-size: 14px;\n    }\n    .employee_tax .employee_tax_1 { position: absolute; top: 204px; left: 503px; }\n    .employee_tax .employee_tax_2 { position: absolute; top: 204px; left: 528px; }\n    .employee_tax .employee_tax_3 { position: absolute; top: 204px; left: 544px; }\n    .employee_tax .employee_tax_4 { position: absolute; top: 204px; left: 560px; }\n    .employee_tax .employee_tax_5 { position: absolute; top: 204px; left: 576px; }\n    .employee_tax .employee_tax_6 { position: absolute; top: 204px; left: 600px; }\n    .employee_tax .employee_tax_7 { position: absolute; top: 204px; left: 616px; }\n    .employee_tax .employee_tax_8 { position: absolute; top: 204px; left: 632px; }\n    .employee_tax .employee_tax_9 { position: absolute; top: 204px; left: 648px; }\n    .employee_tax .employee_tax_10 { position: absolute; top: 204px; left: 664px; }\n    .employee_tax .employee_tax_11 { position: absolute; top: 204px; left: 688px; }\n    .employee_tax .employee_tax_12 { position: absolute; top: 204px; left: 704px; }\n    .employee_tax .employee_tax_13 { position: absolute; top: 204px; left: 730px; }\n\n.employee_name {\n    font-size: 14px;\n    position: absolute;\n    top: 227px;\n    left: 80px; \n    width: 1000px;\n}\n.employee_address {\n    font-size: 14px;\n    position: absolute;\n    top: 266px;\n    left: 80px; \n    width: 1000px;\n}\n.income_tax_form {\n    font-size: 16px;\n    }\n    .income_tax_form .choice_pnd1a {position: absolute; top: 302px; left: 282px; }\n    .income_tax_form .choice_pnd3 {position: absolute; top: 302px; left: 632px; }\n    .income_tax_form .choice_pnd3a {position: absolute; top: 326px; left: 386px; }\n    .income_tax_form .choice_pnd53 {position: absolute; top: 326px; left: 530px; }\n.wht_items {\n    font-size: 12px;\n    text-align: right;\n    }\n    .wht_items .type_1_date {position: absolute; top: 393px; left: 450px; }\n    .wht_items .type_1_base {position: absolute; top: 393px; right: 145px; width:200px; }\n    .wht_items .type_1_tax {position: absolute; top: 393px; right: 50px; width:200px; }\n    \n    .wht_items .type_2_date {position: absolute; top: 413px; left: 450px; }\n    .wht_items .type_2_base {position: absolute; top: 413px; right: 145px; width:200px; }\n    .wht_items .type_2_tax {position: absolute; top: 413px; right: 50px; width:200px; }\n    \n    .wht_items .type_3_date {position: absolute; top: 433px; left: 450px; }\n    .wht_items .type_3_base {position: absolute; top: 433px; right: 145px; width:200px; }\n    .wht_items .type_3_tax {position: absolute; top: 433px; right: 50px; width:200px; }\n    \n    .wht_items .type_4_date {position: absolute; top: 453px; left: 450px; }\n    .wht_items .type_4_base {position: absolute; top: 453px; right: 145px; width:200px; }\n    .wht_items .type_4_tax {position: absolute; top: 453px; right: 50px; width:200px; }\n    \n    .wht_items .type_411_date {position: absolute; top: 528px; left: 450px; }\n    .wht_items .type_411_base {position: absolute; top: 528px; right: 145px; width:200px; }\n    .wht_items .type_411_tax {position: absolute; top: 528px; right: 50px; width:200px; }\n    \n    .wht_items .type_412_date {position: absolute; top: 548px; left: 450px; }\n    .wht_items .type_412_base {position: absolute; top: 548px; right: 145px; width:200px; }\n    .wht_items .type_412_tax {position: absolute; top: 548px; right: 50px; width:200px; }\n    \n    .wht_items .type_413_date {position: absolute; top: 568px; left: 450px; }\n    .wht_items .type_413_base {position: absolute; top: 568px; right: 145px; width:200px; }\n    .wht_items .type_413_tax {position: absolute; top: 568px; right: 50px; width:200px; }\n    \n    .wht_items .type_414_date {position: absolute; top: 588px; left: 450px; }\n    .wht_items .type_414_base {position: absolute; top: 588px; right: 145px; width:200px; }\n    .wht_items .type_414_tax {position: absolute; top: 588px; right: 50px; width:200px; }\n    \n    .wht_items .type_421_date {position: absolute; top: 626px; left: 450px; }\n    .wht_items .type_421_base {position: absolute; top: 626px; right: 145px; width:200px; }\n    .wht_items .type_421_tax {position: absolute; top: 626px; right: 50px; width:200px; }\n    \n    .wht_items .type_422_date {position: absolute; top: 665px; left: 450px; }\n    .wht_items .type_422_base {position: absolute; top: 665px; right: 145px; width:200px; }\n    .wht_items .type_422_tax {position: absolute; top: 665px; right: 50px; width:200px; }\n    \n    .wht_items .type_423_date {position: absolute; top: 704px; left: 450px; }\n    .wht_items .type_423_base {position: absolute; top: 704px; right: 145px; width:200px; }\n    .wht_items .type_423_tax {position: absolute; top: 704px; right: 50px; width:200px; }\n    \n    .wht_items .type_424_date {position: absolute; top: 726px; left: 450px; }\n    .wht_items .type_424_base {position: absolute; top: 726px; right: 145px; width:200px; }\n    .wht_items .type_424_tax {position: absolute; top: 726px; right: 50px; width:200px; }\n    \n    .wht_items .type_425_date {position: absolute; top: 744px; left: 450px; }\n    .wht_items .type_425_base {position: absolute; top: 744px; right: 145px; width:200px; }\n    .wht_items .type_425_tax {position: absolute; top: 744px; right: 50px; width:200px; }\n    \n    .wht_items .type_5_date {position: absolute; top: 820px; left: 450px; }\n    .wht_items .type_5_base {position: absolute; top: 820px; right: 145px; width:200px; }\n    .wht_items .type_5_tax {position: absolute; top: 820px; right: 50px; width:200px; }\n    \n    .wht_items .type_6_desc {position: absolute; top: 842px; left: 150px; }\n    .wht_items .type_6_date {position: absolute; top: 839px; left: 450px; }\n    .wht_items .type_6_base {position: absolute; top: 839px; right: 145px; width:200px; }\n    .wht_items .type_6_tax {position: absolute; top: 839px; right: 50px; width:200px; }\n    \n    .wht_items .commutation_date {position: absolute; top: 413px; left: 450px; }\n    .wht_items .commutation_earning {position: absolute; top: 413px; right: 145px; width:200px; }\n    .wht_items .commutation_tax {position: absolute; top: 413px; right: 50px; width:200px; }\n    \n\n.total_base {\n    font-size: 12px;\n    position: absolute;\n    top: 865px;\n    right: 145px;\n    width:200px;\n    text-align: right;\n}\n.total_tax {\n    font-size: 12px;\n    position: absolute;\n    top: 865px;\n    right: 50px;\n    width:200px;\n    text-align: right;\n}\n.amount_in_words {\n    font-size: 12px;\n    position: absolute;\n    top: 894px;\n    left: 250px;\n}\n.tax_payer {\n    font-size: 14px;\n}\n.tax_payer .tax_payer_withholding {position: absolute; top: 945px; left: 113px; }\n.tax_payer .tax_payer_paid_one_time {position: absolute; top: 945px; left: 382px; }\n    \n.year-to-date-pvd {\n    font-size: 10px;\n    position: absolute;\n    top: 920px;\n    left: 665px;\n    width:200px;\n    text-align: left;\n}\n",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Withholding Tax Cert Employee",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "font_size": 0,
 "html": "<style>\n\t.print-format {\n\t\tpadding: 0px;\n\t\tmargin-right: 0mm;\n\t\tmargin-left: 0mm;\n\t\tmargin-top: 0mm;\n\t\tmargin-bottom: 0mm;\n\t}\n</style>\n\n<div class=\"page-break\">\n    <div class=\"o_report_withholding_tax_cert\" colspan=\"4\">\n        \n        <div class=\"signature\" >\n            {% set signer = get_employee_name_by_user(doc.submitted_by) %}\n            {{ signer or frappe.get_fullname(doc.submitted_by) }}\n        </div>\n        <div class=\"sign_date\" >\n            {{ thai_date(doc.date) }}\n        </div>\n        <div class=\"number\">\n            {{ doc.name }}\n        </div>\n        <!--<div class=\"number_payment\">-->\n        <!--    {{ doc.voucher_no }}-->\n        <!--</div>-->\n        {% if doc.company_tax_id %}\n        <div class=\"company_vat\">\n            <div class=\"company_vat_1\">\n                {{ doc.company_tax_id[:1] }}\n            </div>\n            <div class=\"company_vat_2\">\n                {{ doc.company_tax_id[1:2] }}\n            </div>\n            <div class=\"company_vat_3\">\n                {{ doc.company_tax_id[2:3] }}\n            </div>\n            <div class=\"company_vat_4\">\n                {{ doc.company_tax_id[3:4] }}\n            </div>\n            <div class=\"company_vat_5\">\n                {{ doc.company_tax_id[4:5] }}\n            </div>\n            <div class=\"company_vat_6\">\n                {{ doc.company_tax_id[5:6] }}\n            </div>\n            <div class=\"company_vat_7\">\n                {{ doc.company_tax_id[6:7] }}\n            </div>\n            <div class=\"company_vat_8\">\n                {{ doc.company_tax_id[7:8] }}\n            </div>\n            <div class=\"company_vat_9\">\n                {{ doc.company_tax_id[8:9] }}\n            </div>\n            <div class=\"company_vat_10\">\n                {{ doc.company_tax_id[9:10] }}\n            </div>\n            <div class=\"company_vat_11\">\n                {{ doc.company_tax_id[10:11] }}\n            </div>\n            <div class=\"company_vat_12\">\n                {{ doc.company_tax_id[11:12] }}\n            </div>\n            <div class=\"company_vat_13\">\n                {{ doc.company_tax_id[12:13] }}\n            </div>\n        </div>\n        {%- endif -%}\n        <div class=\"company_name\">\n            <p>\n                {{ doc.company }}\n            </p>\n        </div>\n        {% set company_address = [] %}\n        {% set a = frappe.get_doc(\"Address\", doc.company_address) %}\n        {% for name in [a.address_line1, a.address_line2, a.city, a.county, a.state, a.pincode] %}\n        {%   if name != None %}\n        {{     company_address.append(name) or '' }}\n        {%   endif %} \n        {% endfor %}\n        <div class=\"company_address\" colspan=\"4\">\n            {{ company_address|join(\", \") }}\n        </div>\n        {% set employee_tax_id = doc.employee_tax_id | replace(\"-\", \"\") %}\n        {% if employee_tax_id %}\n        <div class=\"employee_tax\">\n            <div class=\"employee_tax_1\">\n                {{ employee_tax_id[:1] }}\n            </div>\n            <div class=\"employee_tax_2\">\n                {{ employee_tax_id[1:2] }}\n            </div>\n            <div class=\"employee_tax_3\">\n                {{ employee_tax_id[2:3] }}\n            </div>\n            <div class=\"employee_tax_4\">\n                {{ employee_tax_id[3:4] }}\n            </div>\n            <div class=\"employee_tax_5\">\n                {{ employee_tax_id[4:5] }}\n            </div>\n            <div class=\"employee_tax_6\">\n                {{ employee_tax_id[5:6] }}\n            </div>\n            <div class=\"employee_tax_7\">\n                {{ employee_tax_id[6:7] }}\n            </div>\n            <div class=\"employee_tax_8\">\n                {{ employee_tax_id[7:8] }}\n            </div>\n            <div class=\"employee_tax_9\">\n                {{ employee_tax_id[8:9] }}\n            </div>\n            <div class=\"employee_tax_10\">\n                {{ employee_tax_id[9:10] }}\n            </div>\n            <div class=\"employee_tax_11\">\n                {{ employee_tax_id[10:11] }}\n            </div>\n            <div class=\"employee_tax_12\">\n                {{ employee_tax_id[11:12] }}\n            </div>\n            <div class=\"employee_tax_13\">\n                {{ employee_tax_id[12:13] }}\n            </div>\n        </div>\n        {%- endif -%}\n        {% set emp = frappe.get_doc(\"Employee\", doc.employee) %}\n        <div class=\"employee_name\">\n            <p>\n                {{ emp.custom_prefix }} {{ doc.employee_name }}\n            </p>\n        </div>\n        <div class=\"employee_address\">\n            {{ doc.employee_address }}\n        </div>\n        <div class=\"income_tax_form\">\n        {% if doc.income_tax_form == 'PND1a' %}\n            <div class=\"choice_pnd1a\">X</div>\n        {% endif %} \n        {% if doc.income_tax_form == 'PND3' %}\n            <div class=\"choice_pnd3\">X</div>\n        {% endif %} \n        {% if doc.income_tax_form == 'PND3a' %}\n            <div class=\"choice_pnd3a\">X</div>\n        {% endif %} \n        {% if doc.income_tax_form == 'PND53' %}\n            <div class=\"choice_pnd53\">X</div>\n        {% endif %} \n        </div>\n        \n        {% set total_base_value = namespace(result=0) %}\n        {% set total_tax_value = namespace(result=0) %}\n        \n        {% set is_commutation_earnings = namespace(result=0) %}\n        {% set earnings_commutation_value = namespace(result=0) %}\n        \n        {% set earnings_data = frappe.get_all('Salary Detail', filters={'parent': doc.voucher_no, 'parentfield': 'earnings'}, fields=['name','salary_component', 'amount', 'parentfield']) %}\n        \n        {% for earning in earnings_data %}\n            {% if '\u0e40\u0e07\u0e34\u0e19\u0e0a\u0e14\u0e40\u0e0a\u0e22' in earning.salary_component %}\n                {% set is_commutation_earnings.result = 1  %}\n                {% set earnings_commutation_value.result = earnings_commutation_value.result + earning.amount| default(0, true)  %}\n            {% endif %}\n        {% endfor %}\n        \n        {% set deductions_data = frappe.get_all('Salary Detail', filters={'parent': doc.voucher_no, 'parentfield': 'deductions'}, fields=['name','salary_component', 'amount', 'parentfield']) %}\n\n        {% set is_commutation_deductions = namespace(result=0) %}\n        {% set deductions_commutation_value = namespace(result=0) %}\n        {% for deduction in deductions_data %}\n            {% if '\u0e40\u0e07\u0e34\u0e19\u0e0a\u0e14\u0e40\u0e0a\u0e22' in deduction.salary_component %}\n                {% set is_commutation_deductions.result = 1  %}\n                {% set deductions_commutation_value.result = deductions_commutation_value.result + deduction.amount| default(0, true)  %}\n            {% endif %}\n        {% endfor %}\n        \n        <div class=\"wht_items\">\n        {% for item in doc.withholding_tax_items %}\n        {%   set type = item.type_of_income|replace('.', '') %}\n        {%   if type == '6' %}\n        <div class=\"type_{{ type }}_desc\">\n            {{ item.description }}\n        </div>\n        {%   endif %}\n        {% if not ((type == '1' or type == '2') and (is_commutation_deductions.result > 0 or is_commutation_earnings.result > 0)) %}\n            <div class=\"type_{{ type }}_date\">\n                {{ thai_date(doc.date) }}\n            </div>\n            <div class=\"type_{{ type }}_base\">\n                {% set total_base_value.result = total_base_value.result + item.tax_base %}\n                {{ frappe.format(item.tax_base, {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n            <div class=\"type_{{ type }}_tax\">\n                {% set total_tax_value.result = total_tax_value.result + item.tax_amount %}\n                {{ frappe.format(item.tax_amount, {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n        {% endif %}\n        \n        {% endfor %}\n       \n        {% set posting_date = frappe.db.get_value('Salary Slip', doc.voucher_no , ['posting_date']) %}\n\n        {% set ssl_data = frappe.db.get_value('Salary Slip', \n            filters={\n                'employee': doc.employee,\n                'posting_date': ['<', posting_date]\n            },\n            fieldname=['posting_date', 'total_income_tax', 'total_earnings'],\n            order_by='posting_date desc'\n        ) %}\n        {% set posting_date_ssl, total_income_tax_ssl, total_earnings_ssl = ssl_data if ssl_data else (None, 0, 0) %}\n        \n        <!-- commutation_data -->\n        {% if is_commutation_deductions.result > 0 and is_commutation_earnings.result > 0 %}\n        \n            <div class=\"type_1_date\">\n                {{ thai_date(posting_date_ssl) }}\n            </div>\n            <div class=\"type_1_base\">\n                {% set total_base_value.result = total_base_value.result + total_earnings_ssl|int %}\n                {{ frappe.format(total_earnings_ssl| default(0, true), {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n            <div class=\"type_1_tax\">\n                {% set total_tax_value.result = total_tax_value.result + total_income_tax_ssl|int %}\n                {{ frappe.format(total_income_tax_ssl| default(0, true), {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n        \n            <div class=\"commutation_date\">\n                {{ thai_date(posting_date) }}\n            </div>\n            <div class=\"commutation_earning\">\n                {% set total_base_value.result = total_base_value.result + earnings_commutation_value.result|int %}\n                {{ frappe.format(earnings_commutation_value.result| default(0, true), {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n            <div class=\"commutation_tax\">\n                {% set total_tax_value.result = total_tax_value.result + deductions_commutation_value.result|int %}\n                {{ frappe.format(deductions_commutation_value.result| default(0, true), {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n            </div>\n        {% endif %}\n        </div>\n\n        <div class=\"total_base\">\n            {{ frappe.format(total_base_value.result, {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") | replace(\"\u0e3f\", \"\") }}\n        </div>\n        <div class=\"total_tax\">\n            {{ frappe.format(total_tax_value.result, {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n        </div>\n        <div class=\"amount_in_words\">\n            {{ amount_in_bahttext(total_tax_value.result) }}\n        </div>\n        <div class=\"tax_payer\">\n        {% if doc.tax_payer == 'Withholding' %}\n            <div class=\"tax_payer_withholding\">X</div>\n        {% endif %} \n        {% if doc.tax_payer == 'Paid One Time' %}\n            <div class=\"tax_payer_paid_one_time\">X</div>\n        {% endif %}\n        \n        {% set ssl_deductions_before_tax_calculation, ssl_employee = frappe.db.get_value('Salary Slip', doc.voucher_no , ['deductions_before_tax_calculation', 'employee']) %}\n\n        {% set eted_pvd_contribution = frappe.db.get_value('Employee Tax Exemption Declaration', {'employee': doc.employee, 'payroll_period': doc.payroll_period }, 'custom_pvd_contribution') %}\n        \n        {% set year_to_date_pvd = ssl_deductions_before_tax_calculation| default(0, true) +  eted_pvd_contribution| default(0, true)%}\n        \n        <div class=\"year-to-date-pvd\">\n            {{ frappe.format(year_to_date_pvd, {'fieldtype': 'Currency'}) | replace(\"\u0e3f\", \"\") }}\n        </div>\n        \n        </div>\n    </div>\n</div>\n\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 0.0,
 "margin_left": 0.0,
 "margin_right": 0.0,
 "margin_top": 0.0,
 "modified": "2025-01-11 15:40:48.931604",
 "modified_by": "Administrator",
 "module": "NXPO HRMS",
 "name": "Withholding Tax Cert Employee NXPO",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_designer": 0,
 "print_designer_template_app": "print_designer",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}